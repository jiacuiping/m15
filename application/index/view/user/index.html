<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>登录记录</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" href="__STATIC__/index/layuiadmin/layui/css/layui.css" media="all">
  <link rel="stylesheet" href="__STATIC__/index/layuiadmin/style/admin.css" media="all">
  <link rel="stylesheet" href="__STATIC__/index/layuiadmin/style/style.css" media="all">
</head>
<style>
  .mtd-shipin-tab-left2{width: 100%}
  .mtd-shipin-tab-left2 ul li{width: 23%;text-align: center}
  .layui-form-label{width: 80px !important;}
  .layui-input-inline{width: 30.2% !important;}
  .changebat {width: 20%;height: 40px;background-color: #1e9fff;text-align: center;line-height: 40px;color: #fff;border-radius: 5px;margin: 25px auto;cursor: pointer;}
</style>
<body>
  <!-- 点击shipin里的详情按钮跳到此页 -->
  <div class="layui-fluid">
    <div class="layui-row layui-col-space15">
      <!-- 标题 -->



      <div class="layui-col-md12">
        <div class="layui-card">
          <div class="layui-card-body layui-shenhuilu clear">
            <img src="{$user.user_avatar}" alt="" class="left">
            <div class="layui-shenhuilu-r left">
              <h4>{$user.user_name}<span class="mianfei-ban">{$user.user_vip.level_name}</span></h4>
              <p>关联抖音号：{$user.dyaccount}</p>
              <p>账号类型：{if $user.user_type eq 2} 讲师 {elseif $user.user_type eq 3} 广告商 {elseif $user.user_type eq 4} MCN {else/} 普通用户 {/if}</p>
            </div>
          </div>
          <div class="layui-card-body">
            {if $user.user_mobile eq ''}
              <p>绑定手机使用账号登录<span class="mianfei-ban">推荐绑定</span>
                <a href="#" style="color: #349adc;margin-left: 20px;">点击绑定</a>
              </p>
              <p>绑定手机号后可设定登录密码</p>
            {/if}
          </div>
        </div>
      </div>  
      <!-- tab导航条 -->
      <div class="layui-col-md12">
        <div class="layui-card">
          <div class="layui-card-body" style="padding: 10px 15px 0 15px;">
            <div class="mtd-shipin-tab-left mtd-shipin-tab-left2">
              <ul class="clear">
                <li><a href="{:url('index')}" {if $type eq 'log'} class="checked-bottom" {/if}>登录记录</a></li>
                <li><a href="{:url('index',array('type'=>'invoice'))}" {if $type eq 'invoice'} class="checked-bottom" {/if}>发票信息</a></li>
                <li><a href="{:url('index',array('type'=>'address'))}" {if $type eq 'address'} class="checked-bottom" {/if}>地址信息</a></li>
                <li><a href="{:url('index',array('type'=>'auth'))}" {if $type eq 'auth'} class="checked-bottom" {/if}>认证信息</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>





      <!-- table -->
      {if $type eq 'log'}
        <div class="layui-col-md12">
          <div class="layui-card">
            <div class="layui-card-body">
              <!-- 表格 -->
              <div class="layui-form">
                <table class="layui-table">
                  <thead>
                    <tr>
                      <th>机器码</th>
                      <th>登录IP</th>
                      <th>登录时间</th>
                      <th>登陆方式</th>
                    </tr> 
                  </thead>
                  <tbody>
                    {volist name="logs" id="item"}
                      <tr>
                        <td>{$item.log_code}{if $item.log_code eq $machinecode} (本机) {/if}</td>
                        <td>{$item.log_ip}</td>
                        <td>{$item.log_time}</td>
                        <td>{if $item.log_type eq 1} 用户名登陆 {elseif $item.log_type eq 2} 手机号登陆 {elseif $item.log_type eq 3} 验证码登陆 {elseif $item.log_type eq 4} 扫码登陆 {/if}</td>
                      </tr>
                    {/volist}
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      {elseif $type eq 'invoice'}

        <div>111</div>

      {elseif $type eq 'address'}
        <div class="layui-col-md12">
          <form class="layui-form" id="addressform">
            <div class="layui-card">
              <div class="layui-card-body">
                <!-- 地址信息 -->
                <div class="jichu-xinxi">
                  <!-- <h3>地址信息</h3> -->
                  <div class="layui-form-item">
                    <label class="layui-form-label">省、市、区</label>
                    <div class="layui-input-inline">
                      <select name="address_province" class="provinceselect">
                        <option value="0" {if $address.address_province eq 0} selected="" {/if}>请选择省</option>
                        {volist name="cityinfos.province" id="prov"}
                          <option value="{$prov.id}" {if $address.address_province eq $prov.id} selected="" {/if}>{$prov.name}</option>
                        {/volist}
                      </select>
                    </div>
                    <div class="layui-input-inline">
                      <select name="address_city" class="cityselect">
                        <option value="0">选择市</option>
                        {volist name="cityinfos.citys" id="city"}
                          <option value="{$city.id}" {if $address.address_city eq $city.id} selected="" {/if}>{$city.name}</option>
                        {/volist}
                      </select>
                    </div>
                    <div class="layui-input-inline" style="margin-right:0px;">
                      <select name="address_area" class="areaselect">
                        <option value="0">选择区</option>
                        {volist name="cityinfos.areas" id="area"}
                          <option value="{$area.id}" {if $address.address_area eq $area.id} selected="" {/if}>{$area.name}</option>
                        {/volist}
                      </select>
                    </div>
                  </div>
                  <div class="layui-form-item">
                    <label class="layui-form-label">详细地址</label>
                    <div class="layui-input-block fp-shangchaun">
                      <input type="text" name="address_info" autocomplete="off" placeholder="请输入详细地址" class="layui-input" value="{$address.address_info}">
                    </div>
                  </div>
                </div>
                <!-- 用户信息 -->
                <div class="jichu-xinxi">
                  <!-- <h3>用户信息</h3> -->
                  <div class="layui-form-item">
                    <label class="layui-form-label">联系人姓名</label>
                    <div class="layui-input-block fp-shangchaun">
                      <input type="text" name="address_contact" autocomplete="off" placeholder="请输入联系人姓名" class="layui-input" value="{$address.address_contact}">
                    </div>
                  </div>
                  <div class="layui-form-item">
                    <label class="layui-form-label">联系电话</label>
                    <div class="layui-input-block fp-shangchaun">
                      <input type="number" name="address_mobile" autocomplete="off" placeholder="请输入联系手机号码" class="layui-input" value="{$address.address_mobile}">
                    </div>
                  </div>
                </div>
                <div class="changebat">提交修改</div>
              </div>
            </div>
          </form>
        </div>
      {elseif $type eq 'auth'}
        <div>222</div>
      {/if}
    </div>
  </div>
  <script src="__STATIC__/index/layuiadmin/layui/layui.js"></script>  
  <script src="__STATIC__/index/layuiadmin/style/js/jquery.min.js"></script>  
  <script src="__STATIC__/index/layuiadmin/style/js/jquery.easy-pie-chart.js"></script>  
  <script src="__STATIC__/index/layuiadmin/style/js/echarts.min.js"></script>
<!--   
  <script>
    // 1.轮播 
    layui.use('carousel', function(){
      var carousel = layui.carousel;
      //建造实例
      carousel.render({
        elem: '#test1'
        ,width: '100%' //设置容器宽度
        ,arrow: 'always' //始终显示箭头
        //,anim: 'updown' //切换动画方式
      });
    });
  </script> -->

  <script>
      layui.config({
          base: '__STATIC__/index/layuiadmin/' //静态资源所在路径
      }).extend({
          index: '/lib/index' //主入口模块
      }).use(['index', 'form', 'layer'], function(){
        var layer = layui.layer
        ,form = layui.form
        ,$ = layui.$;


        form.on('select', function(data){
          $.ajax({
            url:"{:url('selectCity')}",
            type:"GET",
            data:{adcode:data.value},
            success:function(res){
              if(res.code == 1){
                if(res.level != 3)
                  appendHtml(res.level,res.citys);
              }else
                layer.msg(res.msg);
            },error:function(){
              layer.msg('服务器错误，请稍后重试');
            }
          })
        });

        function appendHtml(level,citys)
        {
          var object = level == 1 ? $(".cityselect") : $(".areaselect");
          var html = level == 1 ? "<option value='0'>选择市</option>" : "<option value='0'>选择区</option>";

          $(citys).each(function(index,item){
            html += "<option value="+item.id+">"+item.name+"</option>";
          });

          object.empty();
          object.append(html);

          form.render('select');
        }

        $(".changebat").click(function(){
          $.ajax({
            url:"{:url('ChangeAddress')}",
            type:"POST",
            data:$("#addressform").serialize(),
            success:function(res){
              layer.msg(res.msg);
              if(res.code)
                setTimeout(function(){window.location.reload()},2000);
            },error:function(){
              layer.msg('服务器错误，请稍后重试');
            }
          });
        });
      });
  </script>

</body>
</html>